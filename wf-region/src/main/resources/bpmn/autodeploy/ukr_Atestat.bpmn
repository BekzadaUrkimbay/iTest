<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:activiti="http://activiti.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://www.activiti.org/test">
  <process id="ukr_Atestat" name="Подання заяви для проходження атестації щодо володіння державною мовою" isExecutable="true">
    <documentation>https://github.com/e-government-ua/iBP/issues/1584</documentation>
    <startEvent id="startevent1" name="Start">
      <extensionElements>
        <activiti:formProperty id="sID_Public_SubjectOrganJoin" name="Оберіть місце проходження атестації" type="select" default="HNTU" required="true"></activiti:formProperty>
        <activiti:formProperty id="bankIdlastName" name="Прізвище" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="bankIdfirstName" name="Ім'я" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="bankIdmiddleName" name="По батькові" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="bankIdPassport" name="Паспортні дані" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="bankIdinn" name="ІПН" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="bankIdAddressFactual" name="Адреса проживання" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="email" name="Е-Mail для зворотнього зв'язку;на цей e-mail Ви отримаєте результат обробки Вашого звернення;" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="phone" name="Ваш номер телефону" type="string" default="+380" required="true"></activiti:formProperty>
        <activiti:formProperty id="atestationType" name="Оберіть тип атестації;Отримати посвідчення без проходження атестації можуть лише особи, що відповідають п. 56 &quot;Порядку атестації осіб, які претендують на вступ на державну службу, щодо вільного володіння державною мовою&quot;, затвердженого постановою КабМіну України від 26 квітня 2017 року № 301" type="enum" required="true">
          <activiti:value id="sEnum1" name="Групове проходження атестації (вартість 316,00 грн.)"></activiti:value>
          <activiti:value id="sEnum2" name="Індивідуальне проходження атестації (вартість 965,00 грн.)"></activiti:value>
          <activiti:value id="sEnum3" name="Видача дубліката посвідчення щодо вільного володіння державною мовою (вартість 51,30 грн.)"></activiti:value>
          <activiti:value id="sEnum4" name="Отримання посвідчення без проходження атестації (вартість 51,30 грн.)"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="sText" name="повідомлення про оплату; ;labelType=info" type="label" default="Після замовлення послуги та перевірки даних на електронну адресу прийде повідомлення з можливістю онлайн оплати атестації або виготовлення посвідчення"></activiti:formProperty>
        <activiti:formProperty id="sText2" name="Зверніть увагу; ;labelType=warning" type="label" default="Увага! Студенти та викладачі ХНТУ не можуть атестуватися в університеті."></activiti:formProperty>
        <activiti:formProperty id="univer_student_or_prof" name="Чи є Ви студентом або співробітником ХНТУ?" type="enum" required="true">
          <activiti:value id="sEnum1" name="Так"></activiti:value>
          <activiti:value id="sEnum2" name="Ні"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="sID_Payment" name="ИД транзакции платежа ; ;bVisible=false" type="string" default=" "></activiti:formProperty>
        <activiti:formProperty id="nID_Subject" name="ИД-номер субъекта ; ;bVisible=false" type="string" default="0"></activiti:formProperty>
        <activiti:formProperty id="sID_Merchant" name="Ви можете сплатити послуги з атестації онлайн (до суми додається комісія системи);після створення платежу обов'язково дайте свою згоду на отримання квитанції про сплату на Ваш e-mail" type="string" default="i5682280054"></activiti:formProperty>
        <activiti:formProperty id="sSum" name="сумма платежа ; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="sID_Currency" name="ИД-строковой валюты ; ;bVisible=false" type="string" default="UAH"></activiti:formProperty>
        <activiti:formProperty id="sDescription" name="строка-описание платежа ; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="sMail_Signature" name="підпис ; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="sPhoneOrgan" name="підпис ; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="doc" name="Документ, що підтверджує право отримання посвідчення без проходження атестації;назва, ким і коли виданий" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="doc_copy" name="Додайте копію документу" type="file" required="true"></activiti:formProperty>
        <activiti:formProperty id="atestation_day" name="Оберіть дату, у яку Ви успішно пройшли атестацію в нашому ВНЗ" type="date" required="true"></activiti:formProperty>
        <activiti:formProperty id="atestation_date_group" name="Оберіть зручні для Вас дату і час проходження атестації;Атестація проводиться за адресою м. Херсон, вул. Бериславське Шосе, 24, корп. 3, ауд. 220" type="enum" required="true">
          <activiti:value id="sEnum1" name="25.11.2017 0 10:00"></activiti:value>
          <activiti:value id="sEnum2" name="23.12.2017 0 10:00"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="atestation_date_individual" name="Оберіть зручні для Вас дату і час проходження атестації;Атестація проводиться за адресою м. Херсон, вул. Бериславське Шосе, 24, корп. 3, ауд. 220" type="date" required="true"></activiti:formProperty>
        <activiti:formProperty id="sShapka" name="sShapka ; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="sMailClerk" name="sMailClerk ; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="atestation_date" name="Дата аттестации ; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="markers1" name="show-hide" type="markers" default="${markerService.loadFromFile('education/ukr_Atestat_1.json')}"></activiti:formProperty>
      </extensionElements>
    </startEvent>
    <serviceTask id="servicetask1" name="Повідомлення про нове звернення" activiti:delegateExpression="#{MailTaskWithAttachmentsAndSMS}">
      <extensionElements>
        <activiti:field name="to">
          <activiti:expression><![CDATA[${sMailClerk}]]></activiti:expression>
        </activiti:field>
        <activiti:field name="from">
          <activiti:string><![CDATA[noreply@igov.org.ua]]></activiti:string>
        </activiti:field>
        <activiti:field name="subject">
          <activiti:string><![CDATA[Подання заяви для проходження атестації щодо володіння державною мовою]]></activiti:string>
        </activiti:field>
        <activiti:field name="text">
          <activiti:expression><![CDATA[[pattern/mail/new_design/_common_employee_notify.html]]]></activiti:expression>
        </activiti:field>
        <activiti:field name="sPhone_SMS">
          <activiti:expression><![CDATA[+380954278878]]></activiti:expression>
        </activiti:field>
        <activiti:field name="sText_SMS">
          <activiti:expression><![CDATA[Shanovnyi kolego! Nadiishlo nove zvernennya [sID_Order] Zaiava na atestaciu. Opracuite na https://region.igov.org.ua/.]]></activiti:expression>
        </activiti:field>
      </extensionElements>
    </serviceTask>
    <userTask id="usertask1" name="Рішення про надання послуги" activiti:candidateGroups="control_${sID_Public_SubjectOrganJoin}">
      <extensionElements>
        <activiti:formProperty id="bankIdlastName" name="Прізвище" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="bankIdfirstName" name="Ім'я" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="bankIdmiddleName" name="По батькові" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="bankIdPassport" name="Паспортні дані" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="bankIdinn" name="ІПН" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="bankIdAddressFactual" name="Адреса проживання" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="email" name="Е-Mail для зворотнього зв'язку" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="phone" name="Номер телефону" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="atestationType" name="Тип атестації" type="enum" writable="false">
          <activiti:value id="sEnum1" name="Групове проходження атестації (вартість 316,00 грн.)"></activiti:value>
          <activiti:value id="sEnum2" name="Індивідуальне проходження атестації (вартість 965,00 грн.)"></activiti:value>
          <activiti:value id="sEnum3" name="Видача дубліката посвідчення щодо вільного володіння державною мовою (вартість 51,30 грн.)"></activiti:value>
          <activiti:value id="sEnum4" name="Отримання посвідчення без проходження атестації (вартість 51,30 грн.)"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="atestation_date_group" name="Обрана дата атестацї" type="enum" writable="false">
          <activiti:value id="sEnum1" name="25.11.2017 0 10:00"></activiti:value>
          <activiti:value id="sEnum2" name="23.12.2017 0 10:00"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="doc" name="Документ, що підтверджує право отримання посвідчення без проходження атестації;назва, ким і коли виданий" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="atestation_day" name="Оберіть дату, у яку Ви успішно пройшли атестацію в нашому ВНЗ" type="date" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sShapka" name="sShapka ; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="sMailClerk" name="sMailClerk ; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="atestation_date" name="Обрана дата аттестации" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="PrintForm_1" name="Заява про видачу атестату без атестування;File title;sPrintFormFileAsPDF=pattern/print/education/ukr_Atestat_atestat.html,sFileName=Zajava" type="file" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sBody_1" name="[pattern/print/education/ukr_Atestat_atestat.html] ; ;bVisible=false ,bPrintform=true" type="string" default="Заява про видачу атестату без атестування" writable="false"></activiti:formProperty>
        <activiti:formProperty id="PrintForm_2" name="Заява про допуск до атестації;File title;sPrintFormFileAsPDF=pattern/print/education/ukr_Atestat_dopusk.html,sFileName=Zajava" type="file" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sBody_2" name="[pattern/print/education/ukr_Atestat_dopusk.html] ; ;bVisible=false ,bPrintform=true" type="string" default="Заява про допуск до атестації" writable="false"></activiti:formProperty>
        <activiti:formProperty id="PrintForm_3" name="Заява про видачу дублікату атестату;File title;sPrintFormFileAsPDF=pattern/print/education/ukr_Atestat_dublikat.html,sFileName=Zajava" type="file" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sBody_3" name="[pattern/print/education/ukr_Atestat_dublikat.html] ; ;bVisible=false ,bPrintform=true" type="string" default="Заява про видачу дублікату атестату" writable="false"></activiti:formProperty>
        <activiti:formProperty id="doc_copy" name="Копія документа, що підтверджує право отримання посвідчення буз проходження атестації; ;bNew=true" type="file" writable="false"></activiti:formProperty>
        <activiti:formProperty id="decide" name="Рішення про надання послуги" type="enum" required="true">
          <activiti:value id="accept" name="Дані перевірені, заявник може оплачувати послугу"></activiti:value>
          <activiti:value id="reject" name="Відмова (вкажіть причину)"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="vidmova" name="Вкажіть причину відмови" type="string"></activiti:formProperty>
        <activiti:formProperty id="markers2" name="show-hide_PF" type="markers" default="${markerService.loadFromFile('education/ukr_Atestat_2.json')}"></activiti:formProperty>
        <activiti:taskListener event="create" delegateExpression="${fileTaskUploadListener}"></activiti:taskListener>
      </extensionElements>
    </userTask>
    <endEvent id="endevent1" name="End"></endEvent>
    <sequenceFlow id="flow1" sourceRef="scripttask1" targetRef="servicetask1"></sequenceFlow>
    <sequenceFlow id="flow3" sourceRef="servicetask2" targetRef="usertask1"></sequenceFlow>
    <serviceTask id="servicetask2" name="Повідомлення громадянину про успішне подання заяви" activiti:delegateExpression="#{MailTaskWithAttachmentsAndSMS}">
      <extensionElements>
        <activiti:field name="from">
          <activiti:string><![CDATA[noreply@igov.org.ua]]></activiti:string>
        </activiti:field>
        <activiti:field name="to">
          <activiti:expression><![CDATA[${email}]]></activiti:expression>
        </activiti:field>
        <activiti:field name="subject">
          <activiti:string><![CDATA[Подання заяви для проходження атестації щодо володіння державною мовою]]></activiti:string>
        </activiti:field>
        <activiti:field name="text">
          <activiti:expression><![CDATA[[pattern/mail/new_design/_common_header.html]
[pattern/mail/new_design/_common_content_start.html]
Ваше звернення успішно зареєстровано. <br>
Результат перевірки введенних данних будуть спрямовані на цей е-мейл найближчим часом.<br>При позитивному рішенні, наступним листом прийде інформація про можливість оплати послуги<br>
[pattern/mail/new_design/_common_content_end.html]  
[pattern/mail/new_design/_common_signature_start.html]
${sMail_Signature}<br>
[pattern/mail/new_design/_common_signature_end.html] 
[pattern/mail/new_design/_common_footer.html]]]></activiti:expression>
        </activiti:field>
        <activiti:field name="sPhone_SMS">
          <activiti:expression><![CDATA[${phone}]]></activiti:expression>
        </activiti:field>
        <activiti:field name="sText_SMS">
          <activiti:expression><![CDATA[Vashe zvernennya [sID_Order] zareestrovano. Detali: igov.org.ua/journal]]></activiti:expression>
        </activiti:field>
        <activiti:field name="saAttachmentsForSend">
          <activiti:expression><![CDATA[" "]]></activiti:expression>
        </activiti:field>
      </extensionElements>
    </serviceTask>
    <sequenceFlow id="flow4" sourceRef="servicetask1" targetRef="servicetask2"></sequenceFlow>
    <exclusiveGateway id="exclusivegateway1" name="Exclusive Gateway"></exclusiveGateway>
    <serviceTask id="servicetask3" name="Повідомлення про відмову в наданні послуги" activiti:delegateExpression="#{MailTaskWithAttachmentsAndSMS}">
      <extensionElements>
        <activiti:field name="from">
          <activiti:string><![CDATA[noreply@igov.org.ua]]></activiti:string>
        </activiti:field>
        <activiti:field name="to">
          <activiti:expression><![CDATA[${email}]]></activiti:expression>
        </activiti:field>
        <activiti:field name="subject">
          <activiti:string><![CDATA[Подання заяви для проходження атестації щодо володіння державною мовою]]></activiti:string>
        </activiti:field>
        <activiti:field name="text">
          <activiti:expression><![CDATA[[pattern/mail/new_design/_common_header.html]
[pattern/mail/new_design/_common_content_start.html]
На жаль, Вам відмовлено в наданні послуги.<br>
Підстава: <br>
${vidmova}<br><br>
Телефон для довідок: ${sPhoneOrgan} <br>
[pattern/mail/new_design/_common_content_end.html]                
[pattern/mail/new_design/_common_signature_start.html]
${sMail_Signature}<br>
[pattern/mail/new_design/_common_signature_end.html]
[pattern/mail/new_design/_common_footer.html]]]></activiti:expression>
        </activiti:field>
        <activiti:field name="sPhone_SMS">
          <activiti:expression><![CDATA[${phone}]]></activiti:expression>
        </activiti:field>
        <activiti:field name="sText_SMS">
          <activiti:expression><![CDATA[Za Vashym zvernennyam  [sID_Order]  vyneseno vidmovu v nadanni poslugy. Detali: igov.org.ua/journal abo u Vashomu email]]></activiti:expression>
        </activiti:field>
        <activiti:field name="saAttachmentsForSend">
          <activiti:expression><![CDATA[" "]]></activiti:expression>
        </activiti:field>
      </extensionElements>
    </serviceTask>
    <serviceTask id="servicetask5" name="Оцінка якості послуги" activiti:delegateExpression="#{MailTaskWithoutAttachment}">
      <extensionElements>
        <activiti:field name="from">
          <activiti:string><![CDATA[noreply@igov.org.ua]]></activiti:string>
        </activiti:field>
        <activiti:field name="to">
          <activiti:expression><![CDATA["${email}"]]></activiti:expression>
        </activiti:field>
        <activiti:field name="subject">
          <activiti:string><![CDATA[Атестація щодо володіння українською мовою]]></activiti:string>
        </activiti:field>
        <activiti:field name="text">
          <activiti:expression><![CDATA[[pattern/mail/new_design/_common_header.html]
 [pattern/mail/new_design/_common_content_start.html]
Дякуємо, Вам що скористались нашим сервісом подання заяви на атестацію з української мови!<br /><br />Ви можете пройти атестацію value{[atestation_date_group]}.<br /><br />
[pattern/mail/new_design/_common_content_end.html]
[pattern/mail/new_design/_common_feedback.html]
[pattern/mail/new_design/_common_signature_start.html]
${sMail_Signature}<br>
[pattern/mail/new_design/_common_signature_end.html]
[pattern/mail/new_design/_common_footer.html]]]></activiti:expression>
        </activiti:field>
      </extensionElements>
    </serviceTask>
    <scriptTask id="scripttask1" name="Script Task" scriptFormat="javascript" activiti:autoStoreVariables="false">
      <script>
var yyyy = ''
var mmm = ''
var ddd = ''
var time = ''      
	var atestationType_enum = execution.getVariable('atestationType')
    if(atestationType_enum == 'sEnum2') {time = execution.getVariable('atestation_date_individual').toString()
	var eest = ''
    eest=time.substr(20,4)
    if(eest == 'EEST'){yyyy=time.substr(25,4)}
    else{yyyy=time.substr(24,4)}
    mmm=time.substr(4,3)
    
if (mmm == 'Jan'){ mmm='01'}
if (mmm == 'Feb'){ mmm='02'}
if (mmm == 'Mar'){ mmm='03'}
if (mmm == 'Apr'){ mmm='04'}
if (mmm == 'May'){ mmm='05'}
if (mmm == 'Jun'){ mmm='06'}
if (mmm == 'Jul'){ mmm='07'}
if (mmm == 'Aug'){ mmm='08'}
if (mmm == 'Sep'){ mmm='09'}
if (mmm == 'Oct'){ mmm='10'}
if (mmm == 'Nov'){ mmm='11'}
if (mmm == 'Dec'){ mmm='12'}

	ddd=time.substr(8,2)

time = ddd+'.'+mmm+'.'+yyyy

execution.setVariable('atestation_date', time)
	}
</script>
    </scriptTask>
    <sequenceFlow id="flow22" name="${univer_student_or_prof != 'sEnum1'}" sourceRef="exclusivegateway3" targetRef="scripttask1">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${univer_student_or_prof != 'sEnum1'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow24" name="${decide=='reject'}" sourceRef="exclusivegateway1" targetRef="servicetask3">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${decide=='reject'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow26" sourceRef="usertask1" targetRef="exclusivegateway1"></sequenceFlow>
    <sequenceFlow id="flow27" sourceRef="servicetask3" targetRef="endevent1"></sequenceFlow>
    <userTask id="usertask2" name="Перевірка оплати і запрошення на тестування" activiti:candidateGroups="control_${sID_Public_SubjectOrganJoin}">
      <extensionElements>
        <activiti:formProperty id="bankIdlastName" name="Прізвище" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="bankIdfirstName" name="Ім'я" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="bankIdmiddleName" name="По батькові" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="bankIdPassport" name="Паспортні дані" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="bankIdinn" name="ІПН" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="bankIdAddressFactual" name="Адреса проживання" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="email" name="Е-Mail для зворотнього зв'язку" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="phone" name="Номер телефону" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="atestationType" name="Тип атестації" type="enum" writable="false">
          <activiti:value id="sEnum1" name="Групове проходження атестації (вартість 316,00 грн.)"></activiti:value>
          <activiti:value id="sEnum2" name="Індивідуальне проходження атестації (вартість 965,00 грн.)"></activiti:value>
          <activiti:value id="sEnum3" name="Видача дубліката посвідчення щодо вільного володіння державною мовою (вартість 51,30 грн.)"></activiti:value>
          <activiti:value id="sEnum4" name="Отримання посвідчення без проходження атестації (вартість 51,30 грн.)"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="atestation_date_group" name="Обрана дата атестацї" type="enum" writable="false">
          <activiti:value id="sEnum1" name="25.11.2017 0 10:00"></activiti:value>
          <activiti:value id="sEnum2" name="23.12.2017 0 10:00"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="doc" name="Документ, що підтверджує право отримання посвідчення без проходження атестації;назва, ким і коли виданий" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="atestation_day" name="Оберіть дату, у яку Ви успішно пройшли атестацію в нашому ВНЗ" type="date" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sShapka" name="sShapka ; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="sMailClerk" name="sMailClerk ; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="atestation_date" name="Обрана дата аттестации" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="PrintForm_1" name="Заява про видачу атестату без атестування;File title;sPrintFormFileAsPDF=pattern/print/education/ukr_Atestat_atestat.html,sFileName=Zajava" type="file" writable="false"></activiti:formProperty>
        <activiti:formProperty id="PrintForm_2" name="Заява про допуск до атестації;File title;sPrintFormFileAsPDF=pattern/print/education/ukr_Atestat_dopusk.html,sFileName=Zajava" type="file" writable="false"></activiti:formProperty>
        <activiti:formProperty id="PrintForm_3" name="Заява про видачу дублікату атестату;File title;sPrintFormFileAsPDF=pattern/print/education/ukr_Atestat_dublikat.html,sFileName=Zajava" type="file" writable="false"></activiti:formProperty>
        <activiti:formProperty id="doc_copy" name="Копія документа, що підтверджує право отримання посвідчення буз проходження атестації; ;bNew=true" type="file" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sIDPayment" name="id платежа" type="string" default="${sID_Payment}" writable="false"></activiti:formProperty>
        <activiti:formProperty id="decide" name="Рішення про надання послуги" type="enum" required="true">
          <activiti:value id="accept" name="Оплата пройшла, можемо надати послугу"></activiti:value>
          <activiti:value id="reject" name="Відмова (вкажіть причину)"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="vidmova" name="Вкажіть причину відмови" type="string"></activiti:formProperty>
        <activiti:formProperty id="markers2" name="show-hide_PF" type="markers" default="${markerService.loadFromFile('education/ukr_Atestat_2.json')}"></activiti:formProperty>
      </extensionElements>
    </userTask>
    <sequenceFlow id="flow30" name="${decide=='accept'} &amp;&amp; ${atestationType=='enum1'}" sourceRef="exclusivegateway2" targetRef="servicetask5">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${decide=='accept' && atestationType=='sEnum1'}]]></conditionExpression>
    </sequenceFlow>
    <serviceTask id="servicetask4" name="Повідомлення громадянину про успішнe подання заяви + liqpay" activiti:delegateExpression="#{MailTaskWithAttachmentsAndSMS}">
      <extensionElements>
        <activiti:field name="from">
          <activiti:string><![CDATA[noreply@igov.org.ua]]></activiti:string>
        </activiti:field>
        <activiti:field name="to">
          <activiti:expression><![CDATA[${email}]]></activiti:expression>
        </activiti:field>
        <activiti:field name="subject">
          <activiti:string><![CDATA[Атестація щодо володіння українською мовою]]></activiti:string>
        </activiti:field>
        <activiti:field name="text">
          <activiti:expression><![CDATA[[pattern/mail/new_design/_common_header.html]
 [pattern/mail/new_design/_common_content_start.html]
Ваші дані успішно перевірені. Ви можете сплатити вартість послуги за посиланням: <br><br>
[paymentButton_LiqPay]<br><br>
Зверніть увагу! Якщо ви вирішили не отримувати послугу після здійснення оплати, гроші за послугу не повертаються.<br>
Перед наданням послуги виконавець перевірить факт оплати і Вам прийде лист з можливістю оцінити зручність послуги.<br>
[pattern/mail/new_design/_common_content_end.html]  
[pattern/mail/new_design/_common_signature_start.html]
${sMail_Signature}<br>
[pattern/mail/new_design/_common_signature_end.html] 
[pattern/mail/new_design/_common_footer.html]]]></activiti:expression>
        </activiti:field>
        <activiti:field name="sPhone_SMS">
          <activiti:expression><![CDATA[${phone}]]></activiti:expression>
        </activiti:field>
        <activiti:field name="sText_SMS">
          <activiti:expression><![CDATA[Vashe zvernennya [sID_Order] zareestrovano. Detali: igov.org.ua/journal]]></activiti:expression>
        </activiti:field>
        <activiti:field name="saAttachmentsForSend">
          <activiti:expression><![CDATA[" "]]></activiti:expression>
        </activiti:field>
      </extensionElements>
    </serviceTask>
    <sequenceFlow id="flow31" name="${decide=='accept'}" sourceRef="exclusivegateway1" targetRef="servicetask4">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${decide=='accept'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow32" sourceRef="servicetask4" targetRef="usertask2"></sequenceFlow>
    <exclusiveGateway id="exclusivegateway2" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="flow33" sourceRef="usertask2" targetRef="exclusivegateway2"></sequenceFlow>
    <sequenceFlow id="flow34" name="${decide=='reject'}" sourceRef="exclusivegateway2" targetRef="servicetask3">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${decide=='reject'}]]></conditionExpression>
    </sequenceFlow>
    <serviceTask id="servicetask6" name="Оцінка якості послуги" activiti:delegateExpression="#{MailTaskWithoutAttachment}">
      <extensionElements>
        <activiti:field name="from">
          <activiti:string><![CDATA[noreply@igov.org.ua]]></activiti:string>
        </activiti:field>
        <activiti:field name="to">
          <activiti:expression><![CDATA["${email}"]]></activiti:expression>
        </activiti:field>
        <activiti:field name="subject">
          <activiti:string><![CDATA[Атестація щодо володіння українською мовою]]></activiti:string>
        </activiti:field>
        <activiti:field name="text">
          <activiti:expression><![CDATA[[pattern/mail/new_design/_common_header.html]
 [pattern/mail/new_design/_common_content_start.html]
Дякуємо, Вам що скористались нашим сервісом подання заяви на атестацію з української мови!<br />
Ви можете забрати атестат у зручний для вас час.<br />
Перед приїздом зателефонуйте нам за телефоном ${sPhoneOrgan}, щоб отримати інформацію про готовність документа <br />

[pattern/mail/new_design/_common_content_end.html]
[pattern/mail/new_design/_common_feedback.html]
[pattern/mail/new_design/_common_signature_start.html]
${sMail_Signature}<br>
[pattern/mail/new_design/_common_signature_end.html]
[pattern/mail/new_design/_common_footer.html]]]></activiti:expression>
        </activiti:field>
      </extensionElements>
    </serviceTask>
    <sequenceFlow id="flow35" name="${decide=='accept' &amp;&amp; atestationType=='enum3'}" sourceRef="exclusivegateway2" targetRef="servicetask6">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${decide=='accept' && atestationType=='sEnum3' || decide=='accept' && atestationType=='sEnum4'}]]></conditionExpression>
    </sequenceFlow>
    <serviceTask id="servicetask7" name="Оцінка якості послуги" activiti:delegateExpression="#{MailTaskWithoutAttachment}">
      <extensionElements>
        <activiti:field name="from">
          <activiti:string><![CDATA[noreply@igov.org.ua]]></activiti:string>
        </activiti:field>
        <activiti:field name="to">
          <activiti:expression><![CDATA["${email}"]]></activiti:expression>
        </activiti:field>
        <activiti:field name="subject">
          <activiti:string><![CDATA[Атестація щодо володіння українською мовою]]></activiti:string>
        </activiti:field>
        <activiti:field name="text">
          <activiti:expression><![CDATA[[pattern/mail/new_design/_common_header.html]
 [pattern/mail/new_design/_common_content_start.html]
Дякуємо, Вам що скористались нашим сервісом подання заяви на атестацію з української мови!<br />Ви можете пройти атестацію ${atestation_date}.<br />
 Про час тестування радимо Вам завчасно домовитись за телефоном ${sPhoneOrgan}<br />
[pattern/mail/new_design/_common_content_end.html]
[pattern/mail/new_design/_common_feedback.html]
[pattern/mail/new_design/_common_signature_start.html]
${sMail_Signature}<br>
[pattern/mail/new_design/_common_signature_end.html]
[pattern/mail/new_design/_common_footer.html]]]></activiti:expression>
        </activiti:field>
      </extensionElements>
    </serviceTask>
    <sequenceFlow id="flow36" name="${decide=='accept'} &amp;&amp; ${atestationType=='enum2'}" sourceRef="exclusivegateway2" targetRef="servicetask7">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${decide=='accept' && atestationType=='sEnum2'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow37" sourceRef="servicetask6" targetRef="endevent1"></sequenceFlow>
    <sequenceFlow id="flow38" sourceRef="servicetask7" targetRef="endevent1"></sequenceFlow>
    <sequenceFlow id="flow39" sourceRef="servicetask5" targetRef="endevent1"></sequenceFlow>
    <serviceTask id="servicetask8" name="Повідомлення про відмову в наданні послуги" activiti:delegateExpression="#{MailTaskWithAttachmentsAndSMS}">
      <extensionElements>
        <activiti:field name="from">
          <activiti:string><![CDATA[noreply@igov.org.ua]]></activiti:string>
        </activiti:field>
        <activiti:field name="to">
          <activiti:expression><![CDATA[${email}]]></activiti:expression>
        </activiti:field>
        <activiti:field name="subject">
          <activiti:string><![CDATA[Подання заяви для проходження атестації щодо володіння державною мовою]]></activiti:string>
        </activiti:field>
        <activiti:field name="text">
          <activiti:expression><![CDATA[[pattern/mail/new_design/_common_header.html]
[pattern/mail/new_design/_common_content_start.html]
На жаль, Вам відмовлено в наданні послуги.<br>
Співробітники і студенти ХНТУ не можут проходити атестацію в університеті<br><br>
Телефон для довідок: ${sPhoneOrgan} <br>
[pattern/mail/new_design/_common_content_end.html]                
[pattern/mail/new_design/_common_signature_start.html]
${sMail_Signature}<br>
[pattern/mail/new_design/_common_signature_end.html]
[pattern/mail/new_design/_common_footer.html]]]></activiti:expression>
        </activiti:field>
        <activiti:field name="sPhone_SMS">
          <activiti:expression><![CDATA[${phone}]]></activiti:expression>
        </activiti:field>
        <activiti:field name="sText_SMS">
          <activiti:expression><![CDATA[Za Vashym zvernennyam  [sID_Order]  vyneseno vidmovu v nadanni poslugy. Detali: igov.org.ua/journal abo u Vashomu email]]></activiti:expression>
        </activiti:field>
        <activiti:field name="saAttachmentsForSend">
          <activiti:expression><![CDATA[" "]]></activiti:expression>
        </activiti:field>
      </extensionElements>
    </serviceTask>
    <exclusiveGateway id="exclusivegateway3" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="flow40" sourceRef="startevent1" targetRef="exclusivegateway3"></sequenceFlow>
    <sequenceFlow id="flow41" name="${univer_student_or_prof=='sEnum1'}" sourceRef="exclusivegateway3" targetRef="servicetask8">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${univer_student_or_prof=='sEnum1'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow42" sourceRef="servicetask8" targetRef="endevent1"></sequenceFlow>
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_ukr_Atestat">
    <bpmndi:BPMNPlane bpmnElement="ukr_Atestat" id="BPMNPlane_ukr_Atestat">
      <bpmndi:BPMNShape bpmnElement="startevent1" id="BPMNShape_startevent1">
        <omgdc:Bounds height="35.0" width="35.0" x="41.0" y="90.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="servicetask1" id="BPMNShape_servicetask1">
        <omgdc:Bounds height="55.0" width="105.0" x="510.0" y="80.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="usertask1" id="BPMNShape_usertask1">
        <omgdc:Bounds height="71.0" width="105.0" x="908.0" y="170.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent1" id="BPMNShape_endevent1">
        <omgdc:Bounds height="35.0" width="35.0" x="110.0" y="451.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="servicetask2" id="BPMNShape_servicetask2">
        <omgdc:Bounds height="71.0" width="105.0" x="908.0" y="72.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway1" id="BPMNShape_exclusivegateway1">
        <omgdc:Bounds height="40.0" width="40.0" x="940.0" y="270.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="servicetask3" id="BPMNShape_servicetask3">
        <omgdc:Bounds height="55.0" width="105.0" x="500.0" y="263.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="servicetask5" id="BPMNShape_servicetask5">
        <omgdc:Bounds height="55.0" width="105.0" x="263.0" y="441.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="scripttask1" id="BPMNShape_scripttask1">
        <omgdc:Bounds height="55.0" width="105.0" x="332.0" y="80.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="usertask2" id="BPMNShape_usertask2">
        <omgdc:Bounds height="55.0" width="105.0" x="908.0" y="441.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="servicetask4" id="BPMNShape_servicetask4">
        <omgdc:Bounds height="55.0" width="105.0" x="908.0" y="361.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway2" id="BPMNShape_exclusivegateway2">
        <omgdc:Bounds height="40.0" width="40.0" x="532.0" y="448.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="servicetask6" id="BPMNShape_servicetask6">
        <omgdc:Bounds height="55.0" width="105.0" x="500.0" y="710.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="servicetask7" id="BPMNShape_servicetask7">
        <omgdc:Bounds height="55.0" width="105.0" x="360.0" y="536.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="servicetask8" id="BPMNShape_servicetask8">
        <omgdc:Bounds height="55.0" width="105.0" x="75.0" y="215.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway3" id="BPMNShape_exclusivegateway3">
        <omgdc:Bounds height="40.0" width="40.0" x="107.0" y="87.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="flow1" id="BPMNEdge_flow1">
        <omgdi:waypoint x="437.0" y="107.0"></omgdi:waypoint>
        <omgdi:waypoint x="510.0" y="107.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow3" id="BPMNEdge_flow3">
        <omgdi:waypoint x="960.0" y="143.0"></omgdi:waypoint>
        <omgdi:waypoint x="960.0" y="170.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow4" id="BPMNEdge_flow4">
        <omgdi:waypoint x="615.0" y="107.0"></omgdi:waypoint>
        <omgdi:waypoint x="908.0" y="107.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow22" id="BPMNEdge_flow22">
        <omgdi:waypoint x="147.0" y="107.0"></omgdi:waypoint>
        <omgdi:waypoint x="332.0" y="107.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="42.0" width="100.0" x="147.0" y="107.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow24" id="BPMNEdge_flow24">
        <omgdi:waypoint x="940.0" y="290.0"></omgdi:waypoint>
        <omgdi:waypoint x="605.0" y="290.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14.0" width="89.0" x="721.0" y="270.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow26" id="BPMNEdge_flow26">
        <omgdi:waypoint x="960.0" y="241.0"></omgdi:waypoint>
        <omgdi:waypoint x="960.0" y="270.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow27" id="BPMNEdge_flow27">
        <omgdi:waypoint x="552.0" y="318.0"></omgdi:waypoint>
        <omgdi:waypoint x="127.0" y="451.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow30" id="BPMNEdge_flow30">
        <omgdi:waypoint x="532.0" y="468.0"></omgdi:waypoint>
        <omgdi:waypoint x="368.0" y="468.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="56.0" width="100.0" x="402.0" y="412.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow31" id="BPMNEdge_flow31">
        <omgdi:waypoint x="960.0" y="310.0"></omgdi:waypoint>
        <omgdi:waypoint x="960.0" y="361.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14.0" width="95.0" x="791.0" y="323.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow32" id="BPMNEdge_flow32">
        <omgdi:waypoint x="960.0" y="416.0"></omgdi:waypoint>
        <omgdi:waypoint x="960.0" y="441.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow33" id="BPMNEdge_flow33">
        <omgdi:waypoint x="908.0" y="468.0"></omgdi:waypoint>
        <omgdi:waypoint x="572.0" y="468.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow34" id="BPMNEdge_flow34">
        <omgdi:waypoint x="552.0" y="448.0"></omgdi:waypoint>
        <omgdi:waypoint x="552.0" y="318.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14.0" width="89.0" x="555.0" y="371.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow35" id="BPMNEdge_flow35">
        <omgdi:waypoint x="552.0" y="488.0"></omgdi:waypoint>
        <omgdi:waypoint x="552.0" y="710.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="56.0" width="100.0" x="572.0" y="599.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow36" id="BPMNEdge_flow36">
        <omgdi:waypoint x="552.0" y="488.0"></omgdi:waypoint>
        <omgdi:waypoint x="412.0" y="536.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="56.0" width="100.0" x="471.0" y="476.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow37" id="BPMNEdge_flow37">
        <omgdi:waypoint x="552.0" y="710.0"></omgdi:waypoint>
        <omgdi:waypoint x="127.0" y="486.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow38" id="BPMNEdge_flow38">
        <omgdi:waypoint x="412.0" y="536.0"></omgdi:waypoint>
        <omgdi:waypoint x="127.0" y="486.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow39" id="BPMNEdge_flow39">
        <omgdi:waypoint x="263.0" y="468.0"></omgdi:waypoint>
        <omgdi:waypoint x="145.0" y="468.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow40" id="BPMNEdge_flow40">
        <omgdi:waypoint x="76.0" y="107.0"></omgdi:waypoint>
        <omgdi:waypoint x="107.0" y="107.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow41" id="BPMNEdge_flow41">
        <omgdi:waypoint x="127.0" y="127.0"></omgdi:waypoint>
        <omgdi:waypoint x="127.0" y="215.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="42.0" width="100.0" x="28.0" y="159.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow42" id="BPMNEdge_flow42">
        <omgdi:waypoint x="127.0" y="270.0"></omgdi:waypoint>
        <omgdi:waypoint x="127.0" y="451.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>